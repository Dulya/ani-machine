/**
 * ani-machine - Declarative animation and machine state
 * @version v0.1.7
 * @link https://github.com/jfroffice/ani-machine
 * @license MIT
 */
var evt=function(){function e(e){e.eventTypes.forEach(function(t){e.element.removeEventListener(t,e.callback)})}function t(e,t,n,a){var r;return 3==arguments.length&&(a=n,n=t,t=void 0),t?(t+=","+t+" *",r=function(n){var r=n.target;r.matches&&r.matches(t)&&(a.handleEvent?a.handleEvent(n):a.call(e,n))}):r=a,"string"==typeof n&&(n=n.split(/[\s,]+/)),n.forEach(function(t){e.addEventListener(t,r)}),{element:e,eventTypes:n,callback:r}}function n(n,a,r,i){function s(t){e(o),i.handleEvent?i.handleEvent(t):i.call(n,t)}var o;3==arguments.length&&(i=r,r=a,a=void 0),o=t(n,a,r,s)}return{one:n,on:t,off:e}}();!function(e){"use strict";function t(e){return new RegExp("(^|\\s+)"+e+"(\\s+|$)")}function n(e,t){var n=a(e,t)?i:r;n(e,t)}var a,r,i;"classList"in document.documentElement?(a=function(e,t){return e.classList.contains(t)},r=function(e,t){e.classList.add(t)},i=function(e,t){e.classList.remove(t)}):(a=function(e,n){return t(n).test(e.className)},r=function(e,t){a(e,t)||(e.className=e.className+" "+t)},i=function(e,n){e.className=e.className.replace(t(n)," ")});var s={hasClass:a,addClass:r,removeClass:i,toggleClass:n,has:a,add:r,remove:i,toggle:n};"function"==typeof define&&define.amd?define(s):e.classie=s}(window);var am={};am.prefix=function(){"use strict";function e(e){var t=document.body||document.documentElement,n=t.style,a=["Moz","Webkit","Khtml","O","ms"],r=e;if("string"==typeof n[r])return e;r=r.charAt(0).toUpperCase()+r.substr(1);for(var i=0;i<a.length;i++)if("string"==typeof n[a[i]+r])return a[i]+r;return!1}var t={WebkitAnimation:"webkitAnimationEnd",OAnimation:"oAnimationEnd",msAnimation:"MSAnimationEnd",animation:"animationend"},n={WebkitTransition:"webkitTransitionEnd",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd",transition:"transitionend"};return{TRANSITION_END_EVENT:n[e("transition")],ANIMATION_END_EVENT:t[e("animation")]}}(),am.parser=function(){"use strict";return function(e){return"enter"===e?e="mouseenter":"leave"===e&&(e="mouseleave"),e}}(),am.viewport=function(){"use strict";function e(e){var t=0,n=0;do isNaN(e.offsetTop)||(t+=e.offsetTop),isNaN(e.offsetLeft)||(n+=e.offsetLeft);while(e=e.offsetParent);return{top:t,left:n}}function t(){var e=window.document.documentElement.clientHeight,t=window.innerHeight;return t>e?t:e}return{isInside:function(n,a){var r=window.pageYOffset,i=r+t(),s=n.offsetHeight,o=e(n).top,c=o+s;return a=a||.5,i>=o+s*a&&c>=r||"fixed"==(n.currentStyle?n.currentStyle:window.getComputedStyle(n,null)).position}}}(),am.styles=function(){"use strict";function e(e,n){return t[e]?void 0:"."+e+"{"+n+"}"}var t={};return{build:function(n,a){var r=e(n,a);if(!r)return n;var i=document.createElement("style");return i.type="text/css",i.innerHTML=r,t[n]=!0,document.getElementsByTagName("head")[0].appendChild(i),n}}}(),am.translate=function(e,t){"use strict";return function(n){var a,r="translate",i=r+n.axis+"("+n.move+")",s=n.scale,o="";return s!==t&&(i+=" scale("+s.value+")",o+=("_scale"+s.value).replace(".","_")),a="-webkit-transform: "+i+";transform: "+i+";",n.opacity!==t&&(a+=" opacity: "+(n.opacity?"1":"0")+";"),o+=r+n.axis+"_"+n.move+"_"+n.opacity,e.build(o.replace(/-/g,"m"),a)}}(am.styles),am.transition=function(e){"use strict";return function(t,n,a){var r=t+" "+n+" "+a,i=r+", rotate, skew, scale, opacity "+r+";",s="_"+r.replace(/ /g,"_").replace(/\./g,"_"),o="-webkit-transition: -webkit-transform "+i+"transition: transform "+i;return e.build(s,o)}}(am.styles),am.transform=function(e,t){"use strict";function n(e){var t,n,a={};return e.forEach(function(r,i){if(n)return void(n=!1);switch(t=e[i+1],r){case"twist":return"left"===t?a.skewx=e[i+2]:"right"===t&&(a.skewx="-"+e[i+2]),void(n=!0);case"rotate":return"left"===t?a.rotatey="-"+e[i+2]:"right"===t&&(a.rotatey=e[i+2]),void(n=!0);case"move":var s=e[i+2];return"left"===t?a.translatex="-"+s:"right"===t?a.translatex=s:"bottom"===t?a.translatey=s:"top"===t&&(a.translatey="-"+s),void(n=!0);case"scale":if(a.scale={},"up"==t||"down"==t?(a.scale.direction=t,a.scale.power=e[i+2]):a.scale.power=t,0!=parseInt(a.scale.power)){var o=.01*parseFloat(a.scale.power);"up"==a.scale.direction&&(o=-o),a.scale.value=1+o}return;case"after":case"wait":return void(a.after=t);case"over":return void(a.over=t);default:return}}),a}return function(a){var r=n(a),i=r.skewx,s=r.skewy,o=r.rotatey,c=r.translatex,u=r.translatey,l=r.scale,f=r.over||"1.0s",m=r.after||"0s",v=r.easing||"ease-in-out",d="",p="";i&&(p+="skewx("+i+") ",d+="skewx"+i),s&&(p+="skewy("+s+") ",d+="skewy"+s),c&&(p+="translatex("+c+")",d+="translatex"+c),u&&(p+="translatey("+u+")",d+="translatey"+u),o&&(p+="rotate("+o+") ",d+="rotate"+o),l&&(p+=" scale("+l.value+")",d+="scale"+l.value.toString().replace(".","_"));var g="-webkit-transform: "+p+" translateZ(0);transform: "+p+" translateZ(0);";return d=d.replace(/-/g,"m"),{target:e.build(d,g),reset:!0,transition:t(f,v,m)}}}(am.styles,am.transition),am.enter=function(e,t){"use strict";function n(e){var t,n={};return e.forEach(function(a,r){switch(t=e[r+1],a){case":enter":return n.enter=t,void(n.axis="top"===n.enter||"bottom"===n.enter?"y":"x");case"move":return void(n.move=t);case"after":case"wait":return void(n.after=t);case"over":return void(n.over=t);case"easing":return void(n.easing=t);case"scale":if(n.scale={},"up"==t||"down"==t?(n.scale.direction=t,n.scale.power=e[r+2]):n.scale.power=t,0!=parseInt(n.scale.power)){var i=.01*parseFloat(n.scale.power);"up"==n.scale.direction&&(i=-i),n.scale.value=1+i}return;default:return}}),n}return function(a){var r=n(a),i=r.enter||"left",s="left"!==i&&"top"!==i?r.move:"-"+r.move,o=r.over||"0.7s",c=r.after||"0s",u=r.easing||"ease-in-out";return{initial:e({axis:r.axis,move:s,scale:r.scale,opacity:!1}),transition:t(o,u,c)}}}(am.translate,am.transition),am.frame=function(){var e=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)};return function(t){e.call(window,t)}}(),am.build=function(e,t,n){"use strict";function a(e){getComputedStyle(e,null).display}function r(t,n,r,i,s){a(t),r&&classie.addClass(t,r);var o=t.getAttribute("data-previous-target");classie.hasClass(t,o)&&classie.removeClass(t,o),classie.addClass(t,i),n&&classie.removeClass(t,n),evt.on(t,e.TRANSITION_END_EVENT,function(){classie.removeClass(t,i),t.setAttribute("data-previous-target",r),s&&s()})}return function(i,s,o,c){var u;return":enter"===s?function(e){u=t(o),classie.addClass(i,u.initial),r(i,u.initial,null,u.transition,function(){e&&e()})}:":transform"===s?function(e){u=n(o),r(i,null,u.target,u.transition,function(){e&&e()})}:":shake"===s?function(t){var n="shake shake-constant shake-"+o[1];a(i),classie.addClass(i,n),evt.one(i,e.ANIMATION_END_EVENT,function(){console.log("animation end : "+n),classie.removeClass(i,o),classie.removeClass(i,"animated"),t&&t()})}:":animate"===s?function(t){var n=o+" animated";console.log("animation start "+n),c&&(n+=" loop"+c),a(i),classie.addClass(i,o),classie.addClass(i,"animated"),evt.one(i,e.ANIMATION_END_EVENT,function(){console.log("animation end : "+n),classie.removeClass(i,o),classie.removeClass(i,"animated"),t&&t()})}:function(){alert("ERROR "+s)}}}(am.prefix,am.enter,am.transform),am.maestro=function(e,t){return{init:function(t){function n(t,n){var r=n.split(" "),i=r[0],s=e(r[1]);[].forEach.call(document.querySelectorAll(i),function(e){evt.on(e,s,function(){a.changeState(t)})})}var a=this,r=t.triggers;a.states=t.states,a.element=t.element,a.jobs=[],a.offs=[],a.currentState,a.running;for(var i in r){var s=r[i];s&&n(i,s)}a.changeState("default")},changeState:function(n){function a(e){c.jobs.push(e),r()}function r(){if(!c.running){var e=c.jobs[0];e&&(c.running=!0,e.run(function(){e.finish(),c.jobs.splice(0,1),c.running=!1,r()}))}}function i(e){if(e){var t=[];for(key in e)t.push(o(e[key]));return t}}function s(e){e=window[e],"function"==typeof e&&e.apply(null,c)}function o(n){function r(){if(m&&s(m),!p)return void i();var e=p.split(" "),t=e[0];e&&(":animate"===t?(n.currentStep+=1,n.currentStep>=e.length?console.warn("try to relaunch animation that is not finished"):a({run:am.build(c.element,t,e[n.currentStep],d),finish:l})):a({run:am.build(c.element,t,e),finish:o}))}function i(){f&&(g!==u&&evt.off(w),c.changeState(f))}function o(){i(),v&&s(v)}function l(){n.currentStep<p.split(" ").length-1?t(r):n.currentStep=0,o()}var f=n.goto,m=n.before?n.before.replace("()",""):"",v=n.after?n.after.replace("()",""):"",d=n.loop,p=n.do,g=e(n.on);n.currentStep=n.currentStep||0;var w;return g===u?t(r):w=evt.on(c.element,g,r),function(){w&&evt.off(w)}}var c=this,u="active",l=c.currentState===n;c.currentState&&c.offs&&!l&&c.offs.forEach(function(e){e()});var f=c.states[n];l?i(f):(c.currentState=n,c.offs=i(f))}}}(am.parser,am.frame),am.init=function(e){return function(t){[].forEach.call(document.querySelectorAll(t.selector),function(n){Object.create(e).init({element:n,states:t.states,triggers:t.triggers})})}}(am.maestro);