/**
 * ani-machine - Declarative animation and machine state
 * @version v0.1.1
 * @link https://github.com/jfroffice/ani-machine
 * @license MIT
 */
var prefix=function(){"use strict";function t(t){var n=document.body||document.documentElement,e=n.style,r=["Moz","Webkit","Khtml","O","ms"],i=t;if("string"==typeof e[i])return t;i=i.charAt(0).toUpperCase()+i.substr(1);for(var a=0;a<r.length;a++)if("string"==typeof e[r[a]+i])return r[a]+i;return!1}var n={WebkitAnimation:"webkitAnimationEnd",OAnimation:"oAnimationEnd",msAnimation:"MSAnimationEnd",animation:"animationend"},e={WebkitTransition:"webkitTransitionEnd",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd",transition:"transitionend"};return{TRANSITION_END_EVENT:e[t("transition")],ANIMATION_END_EVENT:n[t("animation")]}}(),tt=function(){"use strict";return{parseOn:function(t){return"enter"===t?t="mouseenter":"leave"===t&&(t="mouseleave"),t}}}(),styles=function(){"use strict";function t(t,n){return e[t]?void 0:(e[t]=!0,"."+t+"{"+n+"}")}function n(n,e){var r=t(n,e);if(!r)return n;var i=document.createElement("style");return i.type="text/css",i.innerHTML=r,document.getElementsByTagName("head")[0].appendChild(i),n}var e={};return{add:n}}(),translate=function(){"use strict";function t(t,n,e){var r="translate",i=r+t+"("+n+"); ",a="-webkit-transform: "+i+"transform: "+i;void 0!==e&&(a+="opacity: "+(e?"1":"0")+";");var o=(r+"_"+t+"_"+n+"_"+e).replace(/-/g,"m");return styles.add(o,a)}return{genCSS:t}}(),transition=function(){"use strict";function t(t,n,e){var r=t+" "+n+" "+e,i=r+", opacity "+r+";",a="_"+r.replace(/ /g,"_").replace(/\./g,"_");return styles.add(a,"-webkit-transition: -webkit-transform "+i+"transition: transform "+i)}return{genCSS:t}}(),enter=function(){"use strict";function t(t){var n,e=t.split(/[, ]+/),r={};return e.forEach(function(t,i){switch(n=e[i+1],t){case"enter":return void(r.enter=n);case"after":case"wait":return void(r.after=n);case"move":return void(r.move=n);case"over":return void(r.over=n);default:return}}),r}function n(n){var e=t("enter "+n),r=e.over||"0.7s",i=e.enter||"left",a="left"!==i&&"top"!==i?e.move:"-"+e.move,o=e.after||"0s",u=e.easing||"ease-in-out",s="x";return!i||"top"!==i&&"bottom"!==i||(s="y"),{initial:translate.genCSS(s,a,!1),transition:transition.genCSS(r,u,o)}}return{genCSS:n}}(),animator=function(){"use strict";function t(t){getComputedStyle(t[0],null).display}function n(n,e,r,i,a){t(n),r&&n.addClass(r),n.addClass(i),e&&n.removeClass(e),n.one(prefix.TRANSITION_END_EVENT,function(){n.removeClass(i),a&&a()})}return{build:function(e,r,i){var a;return"enter"===r?function(t){a=enter.genCSS(i),e.addClass(a.initial),n(e,a.initial,null,a.transition,function(){t&&t()})}:function(n){t(e);var r=i+" animated";e.addClass(r).one(prefix.ANIMATION_END_EVENT,function(){e.removeClass(r),n&&n()})}}}}();angular.module("aniMachine",[]).directive("amElement",["$timeout",function(t){var n="active";return{restrict:"A",scope:{enter:"@"},link:function(e,r,i){function a(t){var n=m===t;if(m&&d&&!n)for(var e=0;e<d.length;e++)d[e]();n?s(p[t]):(m=t,d=s(p[t]))}function o(){for(var t in g){var n=g[t];n&&u(t,n)}}function u(t,n){var e=n.split(" "),r=e[0],i=tt.parseOn(e[1]);[].forEach.call(document.querySelectorAll(r),function(n){n.addEventListener(i,function(){a(t)})})}function s(t){if(t){var n=[];return t.forEach(function(t){n.push(l(t))}),n}}function c(t){E.push(t),f()}function f(){if(!v){var t=E[0];t&&(v=!0,t.run(function(){t.finish(),E.splice(0,1),v=!1,f()}))}}function l(e){function i(){e.currentStep<e.param.split(" ").length-1?t(s,0):e.currentStep=-1,o&&(u!==n&&r.off(u,s),a(o))}var o=e.goto,u=e.on,s=function(){var t=e.param.split(" ");e.currentStep+=1,e.currentStep>=t.length?console.warn("try to relaunch animation that is not finished"):c({run:animator.build(r,e.type,t[e.currentStep]),finish:i})};return u===n?t(s,0):r.on(u,s),function(){r.off(u,s)}}var v,d,m,p=e.events,g=e.triggers,E=[];return o(),i.enter?void c({run:animator.build(r,"enter",i.enter),finish:function(){a("default")}}):void a("default")},controller:["$scope","$element",function(t){t.events={},t.triggers={},this.setEvents=function(n,e,r){n=n||"default",t.events[n]=r,t.triggers[n]=e}}]}}]).directive("amState",function(){return{restrict:"E",scope:{value:"@",trigger:"@"},require:"^amElement",link:function(t,n,e,r){r.setEvents(t.value,t.trigger,t.events)},controller:["$scope",function(t){t.events=[],this.addEvent=function(n){t.events.push(n)}}]}}).directive("amEvent",function(){return{restrict:"E",scope:{on:"@",animate:"@",enter:"@","goto":"@"},require:"^amState",link:function(t,n,e,r){var i,a,o=tt.parseOn(t.on);t.enter?(i="enter",a=t.enter):t.animate&&(i="animate",a=t.animate),r.addEvent({on:o,type:i,param:a,currentStep:-1,"goto":t.goto})}}});